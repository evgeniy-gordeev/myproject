{% extends 'base.html' %}

{% block content %}

  <form method="post" enctype="multipart/form-data">
    <h1>Создать новый пост</h1>
    {% csrf_token %}

    {% comment %}Заголовок{% endcomment %}
    <div class="form-field">
      <label for="id_title" class="form-label" style="display: block; margin-bottom: 10px;"><strong>Заголовок:</strong></label>
      <input type="text" name="title" id="id_title" class="form-input" style="width: 500px; height: 30px; margin-bottom: 10px;" required>
    </div>
    
    {% comment %}Содержание{% endcomment %}
    <div class="form-field">
      <label for="id_content" class="form-label" style="display: block; margin-bottom: 10px;"><strong>Содержание:</strong></label>
      <textarea name="content" id="id_content" class="form-textarea" style="width: 500px; height: 200px;" required></textarea>
      <div class="formatting-buttons">
        <button type="button" onclick="formatText('bold')" class="formatting-button"><b>Ж</b></button>
        <button type="button" onclick="formatText('italic')" class="formatting-button"><i>К</i></button>
        <button type="button" onclick="formatText('underline')" class="formatting-button"><u>П</u></button>
        <button type="button" onclick="formatText('orderedList')" class="formatting-button">1.</button>
        <button type="button" onclick="formatText('unorderedList')" class="formatting-button">&bull;</button>
        <button type="button" onclick="formatText('link')" class="formatting-button">Ссылка</button>
      </div>
    </div>

    {% comment %}Вставить картинку{% endcomment %}
    <div class="form-field">
      <input type="file" id="id_image" name="image" accept="image/*">
    </div>
    
    <button type="submit" class="create-button" style="background-color: blue; color: white; font-size: 14px; margin-top: 40px;">Создать</button>
  </form>

  <div>
    <img src="../../static/images.png" alt="Вопрос" class="question-image" style="position: absolute; top: 100px; right: 200px; width: 296px; height: 170px; background: transparent;">
  </div>

  <script>
    function formatText(style) {
      var textarea = document.getElementById('id_content');
      var start = textarea.selectionStart;
      var end = textarea.selectionEnd;
      var selectedText = textarea.value.substring(start, end);
      var formattedText = '';
    
      if (style === 'bold') {
        formattedText = '<strong>' + selectedText + '</strong>';
      } else if (style === 'italic') {
        formattedText = '<em>' + selectedText + '</em>';
      } else if (style === 'underline') {
        formattedText = '<u>' + selectedText + '</u>';
      } else if (style === 'orderedList') {
        var lines = selectedText.split('\n');
        formattedText = lines.map(function(line, index) {
          return (index + 1) + '. ' + line;
        }).join('\n');
      } else if (style === 'unorderedList') {
        var lines = selectedText.split('\n');
        formattedText = lines.map(function(line) {
          return '• ' + line;
        }).join('\n');
      } else if (style === 'link') {
        var url = prompt('Введите URL ссылки:');
        if (url) {
          formattedText = '<a href="' + url + '">' + selectedText + '</a>';
        }
      }
    
      var updatedValue = textarea.value.substring(0, start) + formattedText + textarea.value.substring(end);
      textarea.value = updatedValue;
      textarea.setSelectionRange(start, start + formattedText.length);
    }
  </script>

{% endblock %}