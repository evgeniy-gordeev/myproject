{% extends 'base.html' %}
{% load static %}
{% block content %}

  <div class="container">

    {% comment %}Заголовок{% endcomment %}

    <div class="heading">
      <h1>All questions</h1>
      <p id="question-count">Total number of questions: {{ questions.count }}</p>
    </div>

    <style>
      .heading {
        margin-top: 50px;
        margin-bottom: -35px;
        margin-left: 20px;
        text-align: left;
      }
    </style>

    {% comment %}Сортировка{% endcomment %}

    <div class="sort-options">
      <label>Sort by:</label>
      <select id="sort-by-select" onchange="handleSortByChange(this)">
        <option value="-created_at" {% if sort_by == '-created_at' %}selected{% endif %}>Newest</option>
        <option value="created_at" {% if sort_by == 'created_at' %}selected{% endif %}>Oldest</option>
      </select>
    </div>

    <script>
      function handleSortByChange(selectElement) {
        const selectedValue = selectElement.value;
        const urlParams = new URLSearchParams(window.location.search);
        urlParams.set('sort_by', selectedValue);
        window.location.search = urlParams.toString();
      }
    </script>

    <style>
      .sort-options {
        margin-bottom: 10px;
        text-align: right;
      }
    </style>

    {% comment %}Вывод вопросов{% endcomment %}

    <div id="question-list">
      {% for question in page %}
        <div class="question">
          <h2 class="question-title"><a href="{% url 'question_detail' question.id %}">{{ question.title }}</a></h2>
          <p class="question-details">{{ question.content }}</p>
          <p class="timestamp">Asked at: {{ question.created_at }}</p>
        </div>
      {% endfor %}
    </div>

    <link rel="stylesheet" href="{% static 'question_detail.css' %}">

    {% comment %}Переключение страниц{% endcomment %}

    <div class="pagination">
      {% if page.has_previous %}
        <a href="?page={{ page.previous_page_number }}">Previous</a>
      {% endif %}
      
      <span class="current-page">{{ page.number }}</span>

      {% if page.has_next %}
        <a href="?page={{ page.next_page_number }}">Next</a>
      {% endif %}
    </div>

    <link rel="stylesheet" href="{% static 'paginator.css' %}">

    {% comment %}Фильтр по заголовку{% endcomment %}

    <div class="search-container">
      <label for="filter-input">Filter by title:</label>
      <input type="text" id="filter-input">
      <button onclick="handleSearch()">Search</button>
    </div>
    
    <script src="{% static 'search_bar.js' %}"></script>
    <link rel="stylesheet" href="{% static 'search_bar.css' %}">

  </div>

  <style>

    body {
      font-family: Arial, sans-serif;
      font-size: 14px;
      line-height: 1.5;
      color: #333333;
      background-color: #f6f6f6;
    }
    .container {
      left:10px;
      transform: scale(0.8);
      max-width: 960px;
      padding: 20px;
      margin: -120px auto 0;
      margin-left: auto;
      margin-right: auto;
    }
  </style>
    
{% endblock %}